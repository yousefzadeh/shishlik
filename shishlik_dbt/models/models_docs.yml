version: 2

models:
  - name: DB_log_table
    config:
      materialized: incremental
      contract:
        enforced: true
    columns:
      - name: ID
        data_type: int
        constraints:
          - type: not_null
      - name: SQL_name
        data_type: varchar(max)    
      - name: SQL_string
        data_type: varchar(max)    
      - name: StartTime
        data_type: datetime    
      - name: EndTime
        data_type: datetime    
  - name: vwThirdPartyControl
    description: |
      This view contains one row per Tenant per Entity Type per Custom Field that are enabled and not deleted.
    columns:
      - name: ThirdPartyControl_Id
      - name: ThirdPartyControl_Name
        description: |
          The Internal Default Name of the custom field.
      - name: ThirdPartyControl_LabelVarchar
      - name: ThirdPartyControl_Label
        description: |
          The Name of the custom field as displayed in APP UI.
      - name: ThirdPartyControl_Placeholder
        description: |
          The Instruction what to enter in the Label of the custom field as displayed in the UI.
      - name: ThirdPartyControl_Type
      - name: ThirdPartyControl_TypeCode
        description: |
          The Type of the custom field.
          1 - Dropdown
          2 - Dynamic/Matrix
          3 - Free Text
          4 - Multiselect Dropdown
          5 - Date
          6 - Rich Text
          7 - Number
          8 - User
      - name: ThirdPartyControl_Enabled
        description: |
          The Enabled flag of the custom field.
          1 - Enabled
          0 - Disabled
          In the case of Hierarchical custom fields, the parent custom field must be enabled for the child custom field to be enabled.  
          If the parent of an enabled child custom field is disabled then the APP will set the parent and the child custom field to be disabled.
      - name: ThirdPartyControl_EntityType
      - name: ThirdPartyControl_EntityTypeCode
        description: |
          The Entity Type of the custom field.
          0 - Third-Party
          1 - Asset
          2 - Risk
          3 - Risk Treatment
          4 - Risk Assessment
          5 - Register
          6 - Issue
          7 - Policy
          8 - Vulnerability
      - name: ThirdPartyControl_RegisterId
      - name: ThirdPartyControl_TenantId
        description: |
          The Tenant Id that created the custom field.
          In hub spoke environments, the Tenant Id will be the Id of the hub and spokes of the hub are allowed to view and assign values to the custom field.
      - name: ThirdPartyControl_ParentThirdPartyControlId
        description: |
          The Parent Id of the custom field.
          Custom fields may have parent child hierarchy up to 3 levels
      - name: ThirdPartyControl_Description
      - name: ThirdPartyControl_Order
        description: |
          The Order of the custom field as displayed in the UI.
  - name: vwAbpEntityPropertyChanges
    description: |
      This view is used to get the list of changes made to the entities in the system.
      This view is used by the AbpEntityChangeSets table.
    columns:
      - name: Id
        description: PK of AbpEntityPropertyChanges table
      - name: EntityChangeId
        description: FK to AbpEntityChanges table
      - name: NewValue
        description: New value of the property
      - name: OriginalValue
        description: Original value of the property
      - name: PropertyName
        description: Name of the property
      - name: PropertyTypeFullName
        description: Type of the property
      - name: PropertyNameVarChar
        description: Name of the property casted to varchar(200)
    
  - name: vwQuestionUser
    description: |
      This table Associates an assigned user review to each Question, QuestionGroup and QuestionGroupResponse.
      One row per Question, or QuestionGroup or QuestionGroupResponse per Assigned Reviewer User or OrganizationUnit.

    columns:
      - name: QuestionUser_ID
        description: PK of QuestionUser table
      - name: QuestionUser_QuestionGroupId
        description: FK to QuestionGroup table (Nullable)
      - name: QuestionUser_QuestionGroupResponseId
        description: FK to QuestionGroupResponse table (Nullable)
      - name: QuestionUser_QuestionId
        description: FK to Question table (Nullable)
      - name: QuestionUser_UserId
        description: FK to AbpUsers table (Nullable)
      - name: QuestionUser_OrganizationUnitId
        description: FK to AbpOrganizationUnits table (Nullable)
      - name: QuestionUser_TenantId

  - name: vwAnswerResponseChooseMany
    description: |
      In the App, the Answer Table is not populating the fields correctly for this question "Choose Many" type and answer "Multi-Select" type. 
      The purpose of this view is to backfill the incorrect values in the Answer table.
      Grain: One row of each Answer and Response for "Multiselect" type for "Choose Many" questions.
      In the case of Multi-choice question, the weighted score of each possible option is in the json of ComponentStr of Question table under "rank" key.
      In the case of Multi-Select type answer, the selected options are in the json of ComponentStr of Answer table under "value" key.
      Columns that are incorrect and re-calculated by this view:
      - AnswerResponse_Key: Sequence number for each Multi-Select answer response
      - Answer_AnswerText: Selected option or freetext for the answer
      - Answer_MaxPossibleScore: Max possible score for this question across all possible options 
      - Answer_Score: Weighted score for the selected option
      - Answer_ResponseCount: 1 for each Multi-Select answer response
    columns:
      - name: Answer_ID
        description: FK to Answer table
      - name: Question_ID
        description: FK to Question table
      - name: AnswerResponse_Key
        description: Seq number of the Response row for the answer
      - name: AnswerResponse_WeightedScore
        description: For each Multi-select response, WeightedScore = Question_Weighting(Question_Id row) * QuestionOption_Rank(Question_Id/Json-Option row) 
      - name: AnswerResponse_MaxPossibleScore
        description: For the Question_Id of the response, max possible score across all possible options for the question
      - name: AnswerResponse_Value
        description: Response Value selected or entered
      - name: AnswerResponse_PK
        description: Constructed Primary Key for the response row
  - name: vwRiskAssessment
    description: |
        List of all RiskAssessments for a given RiskId
        - Included deleted RiskAssessments
        - included a row with zero RiskAssessmentId where no assessments are done for a risk
    columns:
      - name: RiskAssessment_Id
        description: Id of the RiskAssessment
      - name: RiskAssessment_CreationTime
        description: CreationTime of the RiskAssessment
      - name: RiskAssessment_CreatorUserId
        description: CreatorUserId of the RiskAssessment
      - name: RiskAssessment_LastModificationTime
        description: LastModificationTime of the RiskAssessment
      - name: RiskAssessment_LastModifierUserId
        description: LastModifierUserId of the RiskAssessment
      - name: RiskAssessment_IsDeleted
        description: IsDeleted flag (1/0) of the RiskAssessment
      - name: RiskAssessment_DeleterUserId
        description: DeleterUserId of the RiskAssessment
      - name: RiskAssessment_DeletionTime
        description: DeletionTime of the RiskAssessment
      - name: RiskAssessment_TenantId
        description: TenantId of the RiskAssessment for data access
      - name: RiskAssessment_RiskId
        description: RiskId of the RiskAssessment
      - name: RiskAssessment_FavouriteId
        description: |
            Favorite RiskAssessment for a given RiskId
            Only 1 Favorite RiskAssessment for a given RiskId
            Can be NULL where no favorite assessment is selected
      - name: RiskAssessment_Label
        description: Label of the RiskAssessment
      - name: RiskAssessment_RiskLabelSequence
        description: Sequence of RiskAssessments for a given RiskAssessment_Label (1,2,3...)
      - name: RiskAssessment_RiskLabelIsCurrent
        description: Latest RiskAssessment for a given RiskAssessment_Label is tagged = 1
      - name: RiskAssessment_Title
        description: Displayed name of the RiskAssessment
      - name: RiskAssessment_SystemRiskAssessmentCode
        description: SystemRiskAssessmentCode of the RiskAssessment
      - name: RiskAssessment_AssessmentDate
        description: AssessmentDate of the RiskAssessment
      - name: RiskAssessment_LatestFlag
        description: |
            One risk can only have one favorite RiskAssessment
            Show the favorite RiskAssessment for a given RiskId
            if there is no favorite RiskAssessment, then the latest RiskAssessment is the favorite
  - name: vwRiskAssessmentMatrixAttributes
    description: |
        * Multi valued attribute list of Risk Assessment
        * Risk Assessments +
        * Custom Attributes - Likelihood, Impact, Rating, Rating description
        * Risk Assessment Tags 

    columns:
      - name: MatrixName
        description: Name of the Matrix
      - name: RiskId
        description: Risk Id
      - name: TenantId
        description: Tenant Id for the login user for data access
      - name: RiskAssessmentId
        description: Risk Assessment Id - 0 if no assessment done for a risk
      - name: RiskAssessment_Label
        description: Risk Assessment Label - one label can have multiple assesssments
      - name: RiskAssessment_RiskLabelIsCurrent
        description: Latest Riaks Assessment that is associated with the Label
      - name: RiskAssessment_FavouriteId
        description: Favourite Risk Assessment Id - only one favourite assessment per risk
      - name: RiskAssessment_Title
        description: Risk Assessment Name
      - name: X_AxisLabel
        description: X Axis Label of the Risk Matrix
      - name: dynaX_AxisLabel
      - name: ThirdPartyDynamicFieldConfiguration_XAxisThirdPartyControlId
      - name: x_attribute_Id
      - name: Likelihood
      - name: Likelihood_Label
      - name: Likelihood_Value
      - name: Y_AxisLabel
        description: Y Axis Label of the Risk Matrix
      - name: dynaY_AxisLabel
      - name: ThirdPartyDynamicFieldConfiguration_YAxisThirdPartyControlId
      - name: y_attribute_Id
      - name: Impact
      - name: Impact_Label
      - name: Impact_Value
      - name: RiskAssessment_LatestFlag
        description: Flag to indicate if the assessment is latest or not - if no favourite assessment then latest assessment is flagged
      - name: Rating Rating
      - name: Rating_Label
      - name: Rating_Value
      - name: RiskAssessment_AssessmentDate
        description: Date when Assessment is created or updated
  - name: vwRiskChildCustomFieldValue
    description: |
      This view shows Custom Field with Assigned Values with Parent Child Custom Fields of Level 2 for Risk
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: RiskAssessment_Id
        description: |
            Id of the Risk Assessment that has assigned value to the custom field
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_InternalDefaultName
        description: Default Name of the Custom Field used Internally and not editable by user.
      - name: CustomField_Level2Value
        description: Value of the Custom Field at Level 2
  - name: vwRiskParentChildCustomFieldValue
    description: |
      This view shows Custom Field with or without Assigned Values with Parent Child Custom Fields up to 3 levels for Risks
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Risk_Id
        description: |
            Id of Risk that has the assigned value to the Custom Field
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_EntityType
        description: |
          Entity of the Custom Field
          - 0 'Third-Party'
          - 1 'Asset'
          - 2 'Risk'
          - 3 'Risk Treatment'
          - 4 'Risk Assessment'
          - 5 'Register'
          - 6 'Issue'
          - 7 'Policy'
          - 8 'Vulnerability'
      - name: CustomField_InternalDefaultName
        description: Default Name of the Custom Field used Internally and not editable by user.
      - name: CustomField_Level1Id
        description: Id of the Custom Field at Level 1
      - name: CustomField_Level1Name
        description: Name of the Custom Field at Level 1
      - name: CustomField_Level1Value
        description: Value of the Custom Field at Level 1
      - name: CustomField_Level2Id
        description: Id of the Custom Field at Level 2 
      - name: CustomField_Level2Name
        description: Name of the Custom Field at Level 2
      - name: CustomField_Level2Value
        description: Value of the Custom Field at Level 2
      - name: CustomField_Level3Id 
        description: Id of the Custom Field at Level 3
      - name: CustomField_Level3Name
        description: Name of the Custom Field at Level 3
      - name: CustomField_Level3Value
        description: Value of the Custom Field at Level 3
  - name: vwRiskAssessmentCustomFieldValue
    description: |
      This view shows the RiskAssessment with Custom Fields and Values for the Tenant.
      
      **Features:**
        1. Spoke has access to Custom Field defined in Hub
        2. Non-text Custom Values and its representation
          - DateValue
          - User/Organization 
          - Number
          - Rich Text - HTML Text
          - Formatting in Yellowfin columns
        4. All custom fields to be listed with or without values defined

    columns:
      - name: RoleType
        description: Whether the Custom Field is Created By or Accessed By the Tenant_Id
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: RiskAssessment_Id
        description: ID of Risk Assessment as defined in RiskAssessment table
      - name: CustomField_Id
        description: ID of CustomField as defined in ThirdPartyControl table 
      - name: CustomField_Name
        description: Name of the Custom Field
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_Value
        description: |
            Value assigned (Coverted to Text as per APP UI) to the Custom Field For the Entity (Risk_Id) at the Tenant (Tenant_Id)
            - Dropdown - One Value
            - Matrix - One Value
            - Multiselect Dropdown - Many Values
            - User - Many Values
            - Organization - Many Values
            - Free Text - One Value
            - Rich Text - One Value
            - Date - One Value formatted as "23 Aug, 2023"
            - Number - One Value formatted as "123456789", "0.123456789" (Not able to present as "123,456,789" using one format expression)
      - name: CustomField_TextValue
        description: Text Value assigned to the Custom Field (Type Free Text, Rich Text)
      - name: CustomField_NumberValue
        description: Number Value assigned to the Custom Field (Type Number)
      - name: CustomField_DateValue
        description: Date Value assigned to the Custom Field (Type Date)
      - name: CustomField_InternalDefaultName
        description: Internal Name of the Custom Field - "RiskDomain" or NULL if user defined
      - name: IsParentChild
        description: Whether the Custom Field is member of a Parent Child relationship
  - name: vwRiskAssessmentParentChildCustomFieldValue
    description: |
      This view shows Custom Field with or without Assigned Values with Parent Child Custom Fields up to 3 levels for Risk Assessments
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: RiskAssessment_Id
        description: |
            Id of the Risk Assessment that has assigned value to the custom field
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_EntityType
        description: |
          Entity of the Custom Field
          - 0 'Third-Party'
          - 1 'Asset'
          - 2 'Risk'
          - 3 'Risk Treatment'
          - 4 'Risk Assessment'
          - 5 'Register'
          - 6 'Issue'
          - 7 'Policy'
          - 8 'Vulnerability'
      - name: CustomField_InternalDefaultName
        description: Default Name of the Custom Field used Internally and not editable by user.
      - name: CustomField_Level1Id
        description: Id of the Custom Field at Level 1
      - name: CustomField_Level1Name
        description: Name of the Custom Field at Level 1
      - name: CustomField_Level1Value
        description: Value of the Custom Field at Level 1
      - name: CustomField_Level2Id
        description: Id of the Custom Field at Level 2 
      - name: CustomField_Level2Name
        description: Name of the Custom Field at Level 2
      - name: CustomField_Level2Value
        description: Value of the Custom Field at Level 2
      - name: CustomField_Level3Id 
        description: Id of the Custom Field at Level 3
      - name: CustomField_Level3Name
        description: Name of the Custom Field at Level 3
      - name: CustomField_Level3Value
        description: Value of the Custom Field at Level 3
  - name: vwRiskCustomFieldValue
    description: |
      This view shows the Risk with Custom Fields and Values for the Tenant
      Features:
        1. Spoke has access to Custom Field defined in Hub
        2. Non-text Custom Values and its representation
        	- DateValue
        	- User/Organization 
        	- Number
        	- Rich Text - HTML Text
        	- Formatting in Yellowfin columns
        3. All custom fields to be listed with or without values defined

    columns:
      - name: RoleType
        description: Whether the Custom Field is Created By or Accessed By the Tenant_Id
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Risk_Id
        description: ID of Risk defined in Risk table
      - name: CustomField_Id
        description: ID of Custom Field defined in ThirdPartyControl table
      - name: CustomField_Name
        description: Name of the Custom Field
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_Value
        description: |
            Value assigned (Converted to Text as per APP UI) to the Custom Field For the Entity (Risk_Id) at the Tenant (Tenant_Id)
            - Dropdown - One Value
            - Matrix - One Value
            - Multiselect Dropdown - Many Values
            - User - Many Values
            - Organization - Many Values
            - Free Text - One Value
            - Rich Text - One Value
            - Date - One Value formatted as "23 Aug, 2023"
            - Number - One Value formatted as "123456789", "0.123456789" (Not able to present as "123,456,789" using one format expression)
      - name: CustomField_TextValue
        description: Text Value assigned to the Custom Field (Type Free Text, Rich Text)
      - name: CustomField_NumberValue
        description: Number Value assigned to the Custom Field (Type Number)
      - name: CustomField_DateValue
        description: Date Value assigned to the Custom Field (Type Date)
  - name: vwRiskGrandChildCustomFieldValue
    description: |
      This view shows Custom Field with Assigned Values with Parent Child Custom Fields of Level 3 for Risk
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Risk_Id
        description: |
            Id of the Risk Assessment that has assigned value to the custom field
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_InternalDefaultName
        description: Default Name of the Custom Field used Internally and not editable by user.
      - name: CustomField_Level3Value
        description: Value of the Custom Field at Level 3
  - name: vwCustomFieldWithCreatedTenant
    description: |
      This view shows the Risk with Custom Fields and Values for the Tenant
    columns:
      - name: Tenant_Id
        description: |
          Tenant Id that can view and assign values to the Custom Field
          - Single Tenants
          - Hub Spoke Tenants
      - name: CustomField_Id 
      - name: CustomField_InternalDefaultName
        description: |
          This is the Internal Default Name of the Custom Field used in the App
      - name: CustomField_Name
        description: |
          This is the Name of the Custom Field that is displayed to the User in the App
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
          This is the Type of the Custom Field
          - 1 Dropdown
          - 2 Matrix
          - 3 Free Text
          - 4 Multiselect Dropdown
          - 5 Date
          - 6 Rich Text
          - 7 Number
          - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_EntityType
        description: |
          Entity of the Custom Field
          - 0 'Third-Party'
          - 1 'Asset'
          - 2 'Risk'
          - 3 'Risk Treatment'
          - 4 'Risk Assessment'
          - 5 'Register'
          - 6 'Issue'
          - 7 'Policy'
          - 8 'Vulnerability'
      - name: ParentCustomField_Id
        description: |
            This is the Parent Custom Field Id of the Custom Field
      - name: IsParentChild
        description: Flag to indicate if Custom Field is member of Parent Child Custom Field
  - name: vwCustomFieldOption
    description: |
      This view shows the Risk with Custom Fields and Values for the Tenant
    columns:
      - name: Tenant_Id
        description: |
          Tenant Id that can view and assign values to the Custom Field
          - Single Tenants
          - Hub Spoke Tenants
      - name: CustomField_Id
      - name: CustomField_InternalDefaultName
        description: |
          This is the Internal Default Name of the Custom Field used in the App
      - name: CustomField_Name
        description: |
          This is the Name of the Custom Field that is displayed to the User in the App
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
          This is the Type of the Custom Field
          - 1 Dropdown
          - 2 Matrix
          - 3 Free Text
          - 4 Multiselect Dropdown
          - 5 Date
          - 6 Rich Text
          - 7 Number
          - 8 User (User or Organization Unit Multiselect)
      - name: CustomFieldOption_Id
      - name: CustomFieldOption_Value
  - name: vwParentChildCustomField
    description: |
      This view forms a template on how to create a view for an Entity (Risk) with Hierarchical Custom Fields up to 3 levels
      Fixes Issues identified:
        1. Spoke has access to Custom Field defined in Hub
        - Volume of rows explodes
        2. Non-text Custom Values and its representation
        - DateValue
        - User/Organization 
        - Number
        - Rich Text - HTML Text
        - Formatting in Yellowfin columns
        3. Grain for Multi-Select Dropdown (Type 3)
        - Filter - multi-row
        - Report column - single row, comma separated list
        4. All custom fields to be listed with or without values defined
        5. Performance
        6. Limited to 3 levels

    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_EntityType
        description: |
          Entity of the Custom Field
          - 0 'Third-Party'
          - 1 'Asset'
          - 2 'Risk'
          - 3 'Risk Treatment'
          - 4 'Risk Assessment'
          - 5 'Register'
          - 6 'Issue'
          - 7 'Policy'
          - 8 'Vulnerability'
      - name: CustomField_InternalDefaultName
        description: Default Name of the Custom Field used Internally and not editable by user. 
      - name: CustomField_Level1Id
        description: Id of the Custom Field at Level 1
      - name: CustomField_Level1Name
        description: Name of the Custom Field at Level 1
      - name: CustomField_Level2Id
        description: Id of the Custom Field at Level 2 
      - name: CustomField_Level2Name
        description: Name of the Custom Field at Level 2
      - name: CustomField_Level3Id 
        description: Id of the Custom Field at Level 3
      - name: CustomField_Level3Name
        description: Name of the Custom Field at Level 3
  - name: vwEntityCustomFieldValueTemplate
    description: |
      This view forms a template on how to create a view for an Entity (Risk) with Custom Fields
      Fixes Issues identified:
        1. Spoke has access to Custom Field defined in Hub
        - Volume of rows explodes
        2. Non-text Custom Values and its representation
        - DateValue
        - User/Organization 
        - Number
        - Rich Text - HTML Text
        - Formatting in Yellowfin columns
        3. Grain for Multi-Select Dropdown (Type 3)
        - Filter - multi-row
        - Report column - single row, comma separated list
        4. All custom fields to be listed with or without values defined
        5. Performance

    columns:
      - name: RoleType
        description: Whether the Custom Field is Created By or Accessed By the Tenant_Id
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Entity_Id
        description: Entity Id - in this case is the Risk_Id
      - name: CustomField_Id
        description: FK to ThirdPartyControl table that defines the Custom Field
      - name: CustomField_Name
        description: Name of the Custom Field
      - name: CustomField_Type
        description: |
            Type of the Custom Field
            - 1 Dropdown
            - 2 Matrix
            - 3 Free Text
            - 4 Multiselect Dropdown
            - 5 Date
            - 6 Rich Text
            - 7 Number
            - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_Value
        description: |
            Value assigned (Coverted to Text as per APP UI) to the Custom Field For the Entity (Risk_Id) at the Tenant (Tenant_Id)
            - Dropdown - One Value
            - Matrix - One Value
            - Multiselect Dropdown - Many Values
            - User - Many Values
            - Organization - Many Values
            - Free Text - One Value
            - Rich Text - One Value
            - Date - One Value formatted as "23 Aug, 2023"
            - Number - One Value formatted as "123456789", "0.123456789" (Not able to present as "123,456,789" using one format expression)
      - name: CustomField_TextValue
        description: Text Value assigned to the Custom Field (Type Free Text, Rich Text)
      - name: CustomField_NumberValue
        description: Number Value assigned to the Custom Field (Type Number)
      - name: CustomField_DateValue
        description: Date Value assigned to the Custom Field (Type Date)
  - name: vwCustomFieldWithHubSpokeAccess
    description: |
      This view shows the Risk with Custom Fields and Values for the Tenant
    columns:
      - name: Tenant_Id
        description: |
          Tenant Id that can view and assign values to the Custom Field
          - Single Tenants
          - Hub Spoke Tenants
      - name: RoleType 
        description: |
          This is the Role Type of the Tenant
          - Created By
          - Accessed By
      - name: CustomField_Id 
      - name: CustomField_InternalDefaultName
        description: |
          This is the Internal Default Name of the Custom Field used in the App
      - name: CustomField_Name
        description: |
          This is the Name of the Custom Field that is displayed to the User in the App
      - name: CustomField_TypeId
      - name: CustomField_Type
        description: |
          This is the Type of the Custom Field
          - 1 Dropdown
          - 2 Matrix
          - 3 Free Text
          - 4 Multiselect Dropdown
          - 5 Date
          - 6 Rich Text
          - 7 Number
          - 8 User (User or Organization Unit Multiselect)
      - name: CustomField_EntityType
        description: |
          Entity of the Custom Field
          - 0 'Third-Party'
          - 1 'Asset'
          - 2 'Risk'
          - 3 'Risk Treatment'
          - 4 'Risk Assessment'
          - 5 'Register'
          - 6 'Issue'
          - 7 'Policy'
          - 8 'Vulnerability'
      - name: ParentCustomField_Id
        description: |
            This is the Parent Custom Field Id of the Custom Field
      - name: IsParentChild
        description: |
            This is the flag to indicate if the Custom Field is a member of Parent Child Custom Field
  - name: DB_Views
    description: |
        List of all tables in the database from the list of objects
        List of Object Types:
        FN	SQL_SCALAR_FUNCTION
        SQ	SERVICE_QUEUE
        F 	FOREIGN_KEY_CONSTRAINT
        U 	USER_TABLE
        D 	DEFAULT_CONSTRAINT
        PK	PRIMARY_KEY_CONSTRAINT
        V 	VIEW
        IT	INTERNAL_TABLE
        P 	SQL_STORED_PROCEDURE
        TR	SQL_TRIGGER
        List of Tables is filter on "U"

    columns:
      - name: name
        description: Name of View
      - name: object_id
      - name: principal_id
      - name: schema_id
      - name: parent_object_id
      - name: type
        description: Object Type "V" is User View
      - name: type_desc
        description: Type Description
      - name: create_date
      - name: modify_date
      - name: is_ms_shipped
      - name: is_published
      - name: is_schema_published
  - name: vwTableColumnMetadata
    description: |
        List of Tables, Columns, and Column Metadata
  - name: DB_Tables
    description: |
        List of all tables in the database from the list of objects
        List of Object Types:
        FN	SQL_SCALAR_FUNCTION
        SQ	SERVICE_QUEUE
        F 	FOREIGN_KEY_CONSTRAINT
        U 	USER_TABLE
        D 	DEFAULT_CONSTRAINT
        PK	PRIMARY_KEY_CONSTRAINT
        V 	VIEW
        IT	INTERNAL_TABLE
        P 	SQL_STORED_PROCEDURE
        TR	SQL_TRIGGER
        List of Tables is filter on "U"

    columns:
      - name: name
        description: Name of table
      - name: object_id
      - name: principal_id
      - name: schema_id
      - name: parent_object_id
      - name: type
        description: Object Type "U" is User Table
      - name: type_desc
        description: Type Description
      - name: create_date
      - name: modify_date
      - name: is_ms_shipped
      - name: is_published
      - name: is_schema_published

  - name: test_case_19895_UK
    description: |
      [Bug 19895 App-UK Query 15](https://dev.azure.com/admin0011/6clicks/_backlogs/backlog/6clicks%20Team/Features)
    tests:
      - expect_acceptable_runtime

  - name: Filter_TemplateRespondingTeam
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template (QBA only)
        - Responding Team for all Completed Assessments created from this Template

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: RespondingTeam
        description: Name of the Responding Team for all assessments created from this template
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment

  - name: Filter_TemplateQBAssessmentVersion
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template (QBA only)
        - Assessment (QBA only)
        - Version of Assessment

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment 
      - name: Assessment_Version
        description: Name of the Assessment Version
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment

  - name: Filter_TemplateAssessmentActualResults
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template
        - Question Based Assessment (Status 4,6) 
        - Actual Results
        For Reqular Question Answer as well as Question Group Answer


    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment
      - name: ActualResults
        description: Actual Results as entered by the responder

  - name: Filter_TemplateQBAssessmentDomain
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template (QBA only)
        - Assessment (QBA only)
        - Domains for the Questions

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment 
      - name: Domain_Name
        description: Domains of the Questions
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment

  - name: Filter_TemplateQBAssessmentActualResults
    description: |
      This view is used in a custom SQL filter for the following View:
      - Question Based Assessment Answer Details
              
      It lists One row per 
      - Template
      - Question Based Assessment (Status 4,6) 
      - Actual Results
      For Reqular Question Answer as well as Question Group Answer


    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment
      - name: ActualResults
        description: Actual Results as entered by the responder
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment
      - name: IsGroupQuestion
        description: |
          Questions are of 2 types:
          0 for Regular Questions in Question table
          1 for Group Questions in GroupQuestion > GroupQuestionResponse tables
          
  - name: Filter_TemplateQBAssessmentStatus
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template (QBA only)
        - Assessment (QBA only)
        - Unique Assessment Status of all versions of Assessments

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment 
      - name: Status
        description: Status of the Assessment versions
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment

  - name: Filter_RiskCustomFieldValue
    description: |
      This view is used to populated filter in YF View
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: CustomField_InternalDefaultName
        description: Internal Name of the Default Custom Field - RiskDomain or NULL (User defined)
      - name: CustomField_Name
        description: Name of the Custom Field for the Risk Entity
      - name: RiskCustomField_Value
        description: Value of the Custom Field for the Risk Entity
      - name: CustomField_Type
        description: Data type of the Custom Field for the Risk Entity
      - name: IsParentChild
        description: Flag to indicate if the Custom Field is a member of Parent Child Relationship
  - name: Filter_AuthorityAssessmentCustomField
    description: |
        This view is used in a custom SQL filter for the following View:
        - Source Authority To RBA View
               
        It lists One row per 
        - Authority 
        - Template
        - Assessment 
        - Assessment Custom Field
        - Assessment WorkFlow (0 QBA, 1 RBA)

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: SourceAuthority_Name
        description: Name of the Authority
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment
      - name: CustomField_Name
        description: Name of the Assessment Custom Field
      - name: Assessment_WorkFlowId
        description: Code of the Assessment WorkFlow (0 QBA, 1 RBA)

  - name: Filter_RiskSpokeGroupCustomField
    description: |
      This view is used to populated filter in YF View
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Group_Level1	
        description: Top Level of Spoke Group Parent Child Relationship
      - name: Group_Level2	
        description: Second Level of Spoke Group Parent Child Relationship
      - name: Group_Level3Plus	
        description: Third Level Plus of Spoke Group Parent Child Relationship
      - name: Spoke_Name
        description: Name of the Spoke Tenant in a Hub Spoke Relationship
      - name: CustomField_InternalDefaultName
        description: Internal Name of the Default Custom Field - RiskDomain or NULL (User defined)
      - name: RiskCustomField_Name
        description: Name of the Custom Field for the Risk Entity
      - name: IsParentChild
        description: Flag to indicate if the Custom Field is a member of Parent Child Relationship

  - name: Filter_TemplateQBAssessmentQuestionTag
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Template (QBA only)
        - Assessment (QBA only)
        - Unique Tags attached to the Questions of all versions of Assessments

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment 
      - name: QuestionTag_Name
        description: Unique Tags attached to the Questions of all versions of Assessments
      - name: QuestionType
        description: |
          QuestionType specifies if the Assessment is Risk or Weighted Score
          1 for Risk Assessment
          2 for Weighted Score Assessment

  - name: Filter_SpokeGroup
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        It lists One row per 
        - Spoke

        In The Filter Group "Assessment (ALL at Hub)", join with the filter on the tenantid:
        select 
        sg.*,
        t.Template_Name,
        t.Assessment_Name,
        t.ActualResults 
        from reporting.Filter_SpokeGroup sg
        join reporting.Filter_TemplateAssessmentActualResults t 
          on sg.Tenant_Id = t.Tenant_Id
        where sg.Tenant_Id = 3  

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: Group_Level1
        description: Group Level 1 of the Spoke Ancestors
      - name: Group_Level2
        description: Group Level 2 of the Spoke Ancestors
      - name: Group_Level3Plus
        description: Group Level 3+ of the Spoke Ancestors
      - name: Spoke_Name
        description: Name of the Spoke (Tenant as Access Filter)

  - name: Filter_RiskSpokeGroupCustomFieldValue
    description: |
      This view is used to populated filter in YF View
    columns:
      - name: Tenant_Id
        description: |
            Login Tenant_Id 
            - One Tenant_Id - The User at Enterprise/Stand-alone Tenant or at Hub or at Spoke
            - Many Tenant_Id - The User at the hub is invited to view the data at the Spoke 
      - name: Group_Level1	
        description: Top Level of Spoke Group Parent Child Relationship
      - name: Group_Level2	
        description: Second Level of Spoke Group Parent Child Relationship
      - name: Group_Level3Plus	
        description: Third Level Plus of Spoke Group Parent Child Relationship
      - name: Spoke_Name
        description: Name of the Spoke Tenant in a Hub Spoke Relationship
      - name: CustomField_InternalDefaultName
        description: Internal Name of the Default Custom Field - RiskDomain or NULL (User defined)
      - name: RiskCustomField_Name
        description: Name of the Custom Field for the Risk Entity
      - name: CustomField_Value
        description: Value of the Custom Field for the Risk Entity
      - name: CustomField_Type
        description: Data type of the Custom Field for the Risk Entity
      - name: IsParentChild
        description: Flag to indicate if the Custom Field is a member of Parent Child Relationship

  - name: Filter_AuthorityAssessmentCustomFieldToTargetAuthority
    description: |
        This view is used in a custom SQL filter for the following View:
        - Target Authority To RBA View
               
        It lists One row per 
        - Authority 
        - Target Authority
        - Template
        - Assessment 
        - Assessment Custom Field
        - Assessment WorkFlow (0 QBA, 1 RBA)

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: SourceAuthority_Name
        description: Name of the Authority
      - name: TargetAuthority_Name
        description: Name of the Mapped Target Authority
      - name: Template_Name
        description: Name of the Assessment Template 
      - name: Assessment_Name
        description: Name of the Assessment
      - name: CustomField_Name
        description: Name of the Assessment Custom Field
      - name: Assessment_WorkFlowId
        description: Code of the Assessment WorkFlow (0 QBA, 1 RBA)
  - name: Filter_RBAssessmentCustomField
    description: |
        This view is used in a custom SQL filter for the following View:
        - Requirements Based Assessments
               
        For RBA, in the set up for creation of assessments, Responding teams will be selected to respond to the assessment. 
        In the Third Party Management screen to setup the Responding Team (Vendor), the Custom Fields are defined with associated Values.
        In addition to that, there are Custom Field and Value defined for Assessments.

        It lists One row per 
        - RBAssessment
        - Custom Field 

    columns:
      - name: Assessment_Name
        description: Name of the RBAssessment
      - name: CustomField_Name
        description: Name of the Custom Field defined for the Assessment 

  - name: Filter_TeamCustomFieldValue
    description: |
        This view is used in a custom SQL filter for the following View:
        - Question Based Assessment Answer Details
               
        For QBA, in the set up for creation of assessments, Responding teams will be selected to respond to the assessment. 
        In the Third Party Management screen to setup the Responding Team (Vendor), the Custom Fields are defined with associated Values.
        For QBA, there are no Custom Fields defined for Assessments.

        It lists One row per 
        - Responding Team (Vendor)
        - Custom Field (For a given Responding Team)

    columns:
      - name: Tenant_Id
        description: ID of Login Tenant for Access Filtering
      - name: CustomField_Name
        description: Name of the Custom Field defined for the Tenant/Team 
      - name: CustomField_Value
        description: Value of the Custom Field defined for the Tenant/Team 

