select
    Controlset_Id,
    Controlset_TenantId,
    Controlset_Name,
    Controlset_Description,
    Controlset_Tags,
    Controlset_SupplierName,
    Controlset_Status,
    Controlset_StatusCode,
    Controlset_Type,
    Controlset_LastReviewDate,
    Controlset_NextReviewDate,
    Controlset_IsTemplate,
    Controlset_TemplatedId,
    Controlset_ParentControlsetId,
    Controlset_RootControlsetId,
    Controlset_Version,
    Controlset_PublishedDate,
    Controlset_PublishedById,
    Controlset_ImageUrl,
    Controlset_HideResponsibilityTasksUntilRepublished,
    Controlset_LastPublishedDate,
    Controlset_IsCurrent,
    ControlsetDomain_Id,
    ControlsetDomain_ControlsetId,
    ControlsetDomain_Name,
    ControlsetDomain_Custom,
    Controls_Id,
    Controls_Name,
    Controls_Detail,
    Controls_Tags,
    Controls_Order,
    Controls_PolicyDomainId,
    Controls_TemplateControlId,
    Controls_TenantId,
    Controls_RiskStatus,
    Controls_Reference,
    Controls_ParentControlId,
    Controls_RootControlId,
    Controls_IsCurrent,
    ResponsibilityControl_Id,
    ResponsibilityControl_ControlId,
    ResponsibilityControl_ResponsibilityId,
    ResponsibilityControl_TenantId
from {{ ref("vwControlset") }} cs
join {{ ref("vwControls") }} c on cs.ControlsetDomain_Id = c.Controls_PolicyDomainId
join {{ ref("vwResponsibilityControl") }} rc on c.Controls_Id = rc.ResponsibilityControl_ControlId
